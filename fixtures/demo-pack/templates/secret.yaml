{# ============================================
   SECRET - Démonstration b64encode, required
   ============================================ #}

apiVersion: v1
kind: Secret
metadata:
  name: {{ release.name }}-secrets
  namespace: {{ release.namespace }}
type: Opaque
data:
  {#- Encodage base64 des secrets -#}
  api-key: {{ values.secrets.apiKey | b64encode }}
  password: {{ values.secrets.password | b64encode }}

  {#- Secret avec valeur requise (échoue si vide) -#}
  database-url: {{ values.env.DATABASE_URL | required | b64encode }}

stringData:
  {#- Données non encodées (K8s les encode automatiquement) -#}
  config-hash: {{ values.config | tojson | sha256 }}

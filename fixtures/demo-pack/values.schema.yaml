# Sherpack Schema for demo-pack
schemaVersion: sherpack/v1
title: Demo Pack Configuration

properties:
  app:
    type: object
    description: Application configuration
    properties:
      name:
        type: string
        required: true
        pattern: "^[a-z][a-z0-9-]*$"
        description: Application name (lowercase, alphanumeric with dashes)
      enabled:
        type: boolean
        default: true
      replicas:
        type: integer
        default: 1
        min: 0
        max: 100

  image:
    type: object
    description: Docker image configuration
    properties:
      repository:
        type: string
        required: true
      tag:
        type: string
        default: latest
      pullPolicy:
        type: string
        default: IfNotPresent
        enumValues:
          - Always
          - IfNotPresent
          - Never

  resources:
    type: object
    description: Resource limits and requests
    properties:
      limits:
        type: object
        properties:
          cpu:
            type: string
          memory:
            type: string
      requests:
        type: object
        properties:
          cpu:
            type: string
          memory:
            type: string

  env:
    type: object
    description: Environment variables

  secrets:
    type: object
    description: Secret values (will be base64 encoded)

  config:
    type: object
    description: Application configuration
    properties:
      server:
        type: object
        properties:
          port:
            type: integer
            default: 8080
            min: 1
            max: 65535
          host:
            type: string
            default: "0.0.0.0"
      database:
        type: object
        properties:
          maxConnections:
            type: integer
            default: 10
          timeout:
            type: integer
            default: 30

  labels:
    type: object
    description: Custom labels for resources

  annotations:
    type: object
    description: Custom annotations for resources

  ports:
    type: array
    description: List of ports to expose
    items:
      type: object
      properties:
        name:
          type: string
          required: true
        port:
          type: integer
          required: true
        targetPort:
          type: integer

  ingress:
    type: object
    description: Ingress configuration
    properties:
      enabled:
        type: boolean
        default: false
      hosts:
        type: array
        items:
          type: string
      tls:
        type: object
        properties:
          enabled:
            type: boolean
            default: false
          secretName:
            type: string

  features:
    type: object
    description: Feature flags
    properties:
      caching:
        type: boolean
        default: false
      rateLimit:
        type: boolean
        default: false
      oauth:
        type: boolean
        default: false

  welcomeMessage:
    type: string
    description: Welcome message displayed to users
